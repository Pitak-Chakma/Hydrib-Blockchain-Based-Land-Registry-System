{% extends "base.html" %}

{% block title %}Register Land - Land Registry System{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-green-50 to-red-50 py-8">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">Register New Land Property</h1>
            <p class="text-gray-600">Add your land property to the blockchain registry</p>
        </div>

        <!-- Registration Form -->
        <div class="bg-white rounded-lg shadow-lg p-8">
            <form id="landRegistrationForm" method="POST" enctype="multipart/form-data">
                <!-- Property Information -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                        </svg>
                        Property Information
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="plot_number" class="block text-sm font-medium text-gray-700 mb-2">Plot Number *</label>
                            <input type="text" id="plot_number" name="plot_number" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   placeholder="e.g., PLT-2024-001">
                        </div>
                        
                        <div>
                            <label for="khatian_number" class="block text-sm font-medium text-gray-700 mb-2">Khatian Number *</label>
                            <input type="text" id="khatian_number" name="khatian_number" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   placeholder="e.g., KH-123456">
                        </div>
                        
                        <div>
                            <label for="dag_number" class="block text-sm font-medium text-gray-700 mb-2">Dag Number *</label>
                            <input type="text" id="dag_number" name="dag_number" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   placeholder="e.g., DAG-789">
                        </div>
                        
                        <div>
                            <label for="land_type" class="block text-sm font-medium text-gray-700 mb-2">Land Type *</label>
                            <select id="land_type" name="land_type" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">Select Land Type</option>
                                <option value="residential">Residential</option>
                                <option value="commercial">Commercial</option>
                                <option value="agricultural">Agricultural</option>
                                <option value="industrial">Industrial</option>
                                <option value="mixed">Mixed Use</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="area" class="block text-sm font-medium text-gray-700 mb-2">Area (in decimal) *</label>
                            <input type="number" id="area" name="area" step="0.01" min="0.01" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   placeholder="e.g., 5.50">
                        </div>
                        
                        <div>
                            <label for="market_value" class="block text-sm font-medium text-gray-700 mb-2">Market Value (BDT) *</label>
                            <input type="number" id="market_value" name="market_value" min="1" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   placeholder="e.g., 5000000">
                        </div>
                    </div>
                </div>

                <!-- Location Information -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                        Location Details
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="division" class="block text-sm font-medium text-gray-700 mb-2">Division *</label>
                            <select id="division" name="division" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">Select Division</option>
                                <option value="Dhaka">Dhaka</option>
                                <option value="Chittagong">Chittagong</option>
                                <option value="Rajshahi">Rajshahi</option>
                                <option value="Khulna">Khulna</option>
                                <option value="Barisal">Barisal</option>
                                <option value="Sylhet">Sylhet</option>
                                <option value="Rangpur">Rangpur</option>
                                <option value="Mymensingh">Mymensingh</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="district" class="block text-sm font-medium text-gray-700 mb-2">District *</label>
                            <input type="text" id="district" name="district" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   placeholder="e.g., Dhaka">
                        </div>
                        
                        <div>
                            <label for="upazila" class="block text-sm font-medium text-gray-700 mb-2">Upazila/Thana *</label>
                            <input type="text" id="upazila" name="upazila" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   placeholder="e.g., Dhanmondi">
                        </div>
                        
                        <div>
                            <label for="mouza" class="block text-sm font-medium text-gray-700 mb-2">Mouza *</label>
                            <input type="text" id="mouza" name="mouza" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   placeholder="e.g., Dhanmondi">
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <label for="address" class="block text-sm font-medium text-gray-700 mb-2">Full Address *</label>
                        <textarea id="address" name="address" rows="3" required
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                  placeholder="Enter complete address with landmarks"></textarea>
                    </div>
                </div>

                <!-- Document Upload -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Supporting Documents
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="deed_document" class="block text-sm font-medium text-gray-700 mb-2">Land Deed/Title Document</label>
                            <input type="file" id="deed_document" name="deed_document" accept=".pdf,.jpg,.jpeg,.png"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <p class="text-xs text-gray-500 mt-1">PDF, JPG, PNG (Max 5MB)</p>
                        </div>
                        
                        <div>
                            <label for="survey_document" class="block text-sm font-medium text-gray-700 mb-2">Survey Document</label>
                            <input type="file" id="survey_document" name="survey_document" accept=".pdf,.jpg,.jpeg,.png"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <p class="text-xs text-gray-500 mt-1">PDF, JPG, PNG (Max 5MB)</p>
                        </div>
                    </div>
                </div>

                <!-- Additional Information -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        Additional Information
                    </h2>
                    
                    <div>
                        <label for="description" class="block text-sm font-medium text-gray-700 mb-2">Property Description</label>
                        <textarea id="description" name="description" rows="4"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                  placeholder="Describe the property, boundaries, special features, etc."></textarea>
                    </div>
                </div>

                <!-- Terms and Conditions -->
                <div class="mb-8">
                    <div class="flex items-start">
                        <input type="checkbox" id="terms" name="terms" required
                               class="mt-1 h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                        <label for="terms" class="ml-2 text-sm text-gray-700">
                            I confirm that all information provided is accurate and I have the legal right to register this property. I understand that providing false information is a criminal offense.
                        </label>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="flex justify-end space-x-4">
                    <a href="{{ url_for('dashboard') }}"
                       class="px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors duration-200">
                        Cancel
                    </a>
                    <button type="submit"
                            class="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 flex items-center">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                        Register Property
                    </button>
                </div>
            </form>
        </div>

        <!-- Information Panel -->
        <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-blue-900 mb-3">Registration Process</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                <div class="flex items-start">
                    <div class="flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold mr-3 mt-0.5">1</div>
                    <div>
                        <h4 class="font-medium text-blue-900">Submit Application</h4>
                        <p class="text-blue-700">Fill out the form with accurate property details and upload required documents.</p>
                    </div>
                </div>
                <div class="flex items-start">
                    <div class="flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold mr-3 mt-0.5">2</div>
                    <div>
                        <h4 class="font-medium text-blue-900">Blockchain Recording</h4>
                        <p class="text-blue-700">Property data is hashed and recorded on the blockchain for immutable storage.</p>
                    </div>
                </div>
                <div class="flex items-start">
                    <div class="flex-shrink-0 w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs font-bold mr-3 mt-0.5">3</div>
                    <div>
                        <h4 class="font-medium text-blue-900">Official Approval</h4>
                        <p class="text-blue-700">Government officials review and approve the registration for legal validity.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Form validation and enhancement
document.getElementById('landRegistrationForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Basic validation
    const requiredFields = this.querySelectorAll('[required]');
    let isValid = true;
    
    requiredFields.forEach(field => {
        if (!field.value.trim()) {
            field.classList.add('border-red-500');
            isValid = false;
        } else {
            field.classList.remove('border-red-500');
        }
    });
    
    if (!isValid) {
        alert('Please fill in all required fields.');
        return;
    }
    
    // Show loading state
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    submitBtn.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Processing...';
    submitBtn.disabled = true;
    
    // Submit the form
    this.submit();
});

// File upload validation
const fileInputs = document.querySelectorAll('input[type="file"]');
fileInputs.forEach(input => {
    input.addEventListener('change', function() {
        const file = this.files[0];
        if (file && file.size > 5 * 1024 * 1024) { // 5MB limit
            alert('File size must be less than 5MB');
            this.value = '';
        }
    });
});

// Auto-format plot number
document.getElementById('plot_number').addEventListener('input', function() {
    let value = this.value.toUpperCase();
    if (value && !value.startsWith('PLT-')) {
        value = 'PLT-' + value.replace(/[^0-9]/g, '');
    }
    this.value = value;
});

// Auto-format khatian number
document.getElementById('khatian_number').addEventListener('input', function() {
    let value = this.value.toUpperCase();
    if (value && !value.startsWith('KH-')) {
        value = 'KH-' + value.replace(/[^0-9]/g, '');
    }
    this.value = value;
});

// Auto-format dag number
document.getElementById('dag_number').addEventListener('input', function() {
    let value = this.value.toUpperCase();
    if (value && !value.startsWith('DAG-')) {
        value = 'DAG-' + value.replace(/[^0-9]/g, '');
    }
    this.value = value;
});
</script>
{% endblock %}